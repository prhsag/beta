name: Check Cycle Status

on:
    workflow_dispatch: 
        inputs:
            proceed:
                description: 'GO/NOGO'
                type: boolean
                required: true
                default: false

jobs:
    get-proceed-status:
        runs-on: ubuntu-latest
        outputs:
            proceed-status: ${{ steps.check-proceed-status.outputs.PROCEED_STATUS }}
    
        steps:
          - name: Checkout code
            uses: actions/checkout@v3
    
          - name: Check Proceed Status
            id: check-proceed-status
            run: |
                if [[ "${{ github.event.inputs.proceed}}" == "true" ]]
                then
                    echo "Proceed Status: ${{ github.event.inputs.proceed }}"
                    echo "PROCEED_STATUS=GO" >> $GITHUB_OUTPUT
                else
                    echo "Proceed Status: NOGO"
                    echo "PROCEED_STATUS=NOGO" >> $GITHUB_OUTPUT
                    exit 1
                fi

    ask-approval:
        needs: get-proceed-status
        if: ${{ always() && needs.get-proceed-status.result == 'failure'  }}
        uses: prhsag/alpha/.github/workflows/request-review.yaml@main
        with:
            process: ${{ needs.get-proceed-status.outputs.proceed-status }}


    

            